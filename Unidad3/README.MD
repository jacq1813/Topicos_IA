# Optimizaci√≥n de Riego con Algoritmo de Enjambre de Part√≠culas (PSO) - Guasave, Sinaloa

Este proyecto implementa el algoritmo de **Optimizaci√≥n por Enjambre de Part√≠culas (PSO)** para resolver un problema de **optimizaci√≥n de localizaci√≥n** de alta dimensi√≥n aplicado a la agricultura de precisi√≥n. El objetivo es determinar la ubicaci√≥n √≥ptima de una red de sensores de humedad en campos agr√≠colas de Guasave, Sinaloa, maximizando la representatividad de la variabilidad h√≠drica del terreno.

---

## Descripci√≥n del Problema
El desaf√≠o es encontrar la **distribuci√≥n ideal de 100 sensores de humedad** en la zona agr√≠cola de Guasave, considerando factores cr√≠ticos que afectan el riego:

1.  **Topograf√≠a:** Micro variaciones de elevaci√≥n (10 a 50 metros).
2.  **Cultivos:** Diferentes requerimientos h√≠dricos de **Ma√≠z**, **Tomate** y **Chile**.
3.  **Condiciones del Suelo:** Zonas con alta salinidad y baja materia org√°nica.

##
El problema se modela en un **espacio de b√∫squeda multidimensional** (200 variables) para lograr la m√°xima cobertura de estas variabilidades.

---

## Algoritmo PSO
El algoritmo PSO fue elegido por su **eficacia en problemas de optimizaci√≥n continua y multidimensional** y su capacidad para encontrar un buen balance entre **exploraci√≥n** y **explotaci√≥n**.

### 1. Modelado de la Part√≠cula (Soluci√≥n)
* **Part√≠cula:** Representa la configuraci√≥n completa de la **red de 100 sensores**.
    * **Dimensi√≥n:** 2 x 100 = 200 dimensiones.
    * **Vector de Posici√≥n (X_i):** (Lat_1, Lon_1, Lat_2, Lon_2,..., Lat_100, Lon_100).

### 2. Funci√≥n de Aptitud (Fitness Function)
La funci√≥n se dise√±√≥ para **maximizar** el puntaje, premiando los sensores ubicados en √°reas de alta importancia y alta variabilidad, mientras penaliza la redundancia.

#### 2.1 Puntaje x Sensor:
* F(X) = Œ£ k=1 hasta N (Puntaje_Sensork) x Penalizacion_distancia
* Puntaje dependiendo del peso:
    * Peso: (Peso_cultivo x 0.4) + (‚àÜHumedad x 0.3) + (Salinidad x 0.2) + (‚àÜElevacion x 0.1)
    * ‚àÜHumedad : Diferencia entre Humedad Actual y Optima x Cultivo
    * ‚àÜElevacion: Diferencia entre Elevacion Actual y Optima x Cultivo
    * Optimas por cultivo: (Maiz %30, Tomate %40, Chile %25)
---
* **Ponderaci√≥n de Variables:** Un punto de dato de cultivo es m√°s importante si su humedad se desv√≠a del √≥ptimo, o si tiene alta salinidad o elevaci√≥n at√≠pica.
* **Restricci√≥n de Redundancia:** Se aplica una penalizaci√≥n (x 0.3) si dos sensores est√°n a menos de 0.05 km (50 metros) de distancia, forzando la dispersi√≥n y la no aglomeraci√≥n.
* **Calidad de cobertura:** Se premia la proximidad (distancia <= 0.5 km) del sensor a los puntos de datos de alto peso, e incluye un bonus por el n√∫mero total de puntos cubiertos.

---
#### 2.2 Calculo de Distancia Harversine (Puntos geograficos)
#### Considerando esto se tom√≥ la f√≥rmula de Haversine para determinar la distancia entre 2 puntos (sensores), esto ya que es √∫til para distancias cortas como lo es la zona de estudio.

* d=2r‚àôarcsin‚Å°(‚àö(„Äñsin„Äó^2 (‚àÜl/2)+cos(l_1 )‚àôcos(l_2 ) „Äñ‚àôsin„Äó^2 (‚àÜŒª/2) )) 
Donde 
- d= distancia entre los dos puntos
- r= radio de la tierra (aproximadamente 6371 km)
- œÜ_1,œÜ_2= latitudes de los puntos (en radianes)
- Œª_1,Œª_2= longitudes de los puntos (en radianes)
- ŒîœÜ=œÜ_2-œÜ_1
- ŒîŒª=Œª_2-Œª_1



---
### 3. Ecuaciones de Movimiento (Base Original de PSO)
La posici√≥n y velocidad de cada part√≠cula se actualizan en cada iteraci√≥n:

* **Actualizaci√≥n de Velocidad:**
    v_i (t+1)=œâv_i (t)+ c_1 r_1  (P_(„Äñbest„Äó_i ) (t)- P_i (t))+ c_2  r_2  (P_global (t)-P_i (t))
    * P_best, i: Mejor posici√≥n personal hist√≥rica.
    * G_best: Mejor posici√≥n global del enjambre.

* **Actualizaci√≥n de Posici√≥n:**
    X_i (t+1)= X_i  (t)+V_i (t+1)

Donde:
- V_i (t+1)=Nueva velocidad
- V_i (t)=Velocidad actual
- œâ= (Inercia)  Mantiene la direcci√≥n de la particula
- c_1=Componente cognitivo,regula el comp.exploratorio del algoritmo 
- c_2=Componente social,movimiento hacia la mejor pos.encontrada
- r_1 r_2=Factores de aleatoriedad(num alea entre 0 y 1)
- X_i (t)=Posicion actual de la Particula
---

## üìà Resultados y An√°lisis de Eficiencia

Se realizaron 6 compilaciones para calibrar los par√°metros y asegurar una convergencia √≥ptima.

### Resumen de Pruebas y Par√°metros
| N. Prueba | Part√≠culas | Iteraciones m√°x. |œâ (Inercia) | C_1 | C_2 | **Mejor Aptitud** | It. de Convergencia |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| **1** | **15** | 30 | **0.7** | **1.5** | **1.5** | **232**  | 28  |
| **2** | 30 | 30 | 0.7 | 1.5 | 1.5 | **232**  | 27  |
| 4 (Control) | 15 | 30 | 1.0 | 2.0 | 2.0 | 152  | 4  |
| 5 | 25 | 100 | 1.0 | 2.0 | 2.0 | 195  | 16  |

### Hallazgos Clave

* **Calibraci√≥n Cr√≠tica de Inercia:** La inercia de **œâ=0.7** fue esencial. La Prueba 4 (con=1.0) tuvo una **convergencia r√°pida y prematura** a un valor sub√≥ptimo de 152, mientras que el valor m√°s bajo de 0.7 permiti√≥ una b√∫squeda **m√°s exhaustiva** y evit√≥ quedar atrapado en m√≠nimos locales.
* **Soluci√≥n √ìptima:** Las pruebas **1 y 2** lograron la **m√°xima aptitud de 232**. La **Prueba 1 (15 part√≠culas)** fue considerada la **m√°s eficiente**, ya que logr√≥ el mismo resultado con menos recursos computacionales.
* **Conclusi√≥n:** La distribuci√≥n final de los 100 sensores cumple el objetivo de **m√°xima representatividad** al aplicar la funci√≥n de aptitud ponderada y la restricci√≥n de aglomeraci√≥n.

---

## üíª Par√°metros Esenciales del C√≥digo (`PSO.ipynb`)
La clase `PSOAgricola` gestiona la optimizaci√≥n. Estos par√°metros se definen en el Notebook:

| Constante/Variable | Valor T√≠pico Usado | Descripci√≥n en el C√≥digo |
| :--- | :--- | :--- |
| `NUM_SENSORES` | `100` | N√∫mero de coordenadas (Lat/Lon) que forman el vector de cada part√≠cula. |
| `HUMEDAD_OPTIMA` | `{'Ma√≠z': 30.0, 'Tomate': 40.0, 'Chile': 25.0}` | Metas de humedad del suelo para cada cultivo, clave para calcular ‚àÜHumedad en el peso del punto. |
| `ELEVACION_PROMEDIO` | `30.0` | Valor de referencia para penalizar la desviaci√≥n de la elevaci√≥n y capturar la variabilidad topogr√°fica. |
| `DISTANCIA_MIN_SENSORES` | `0.05` km | L√≠mite inferior de la distancia Haversine. Si la distancia entre dos sensores es menor, se aplica una penalizaci√≥n fuerte (x 0.3) en el *fitness*. |
| `DISTANCIA_MAX_COBERTURA` | `0.5` km | L√≠mite Para cada sensor llegue a un optimo alcanzado. |

### 4. Referencias
- Avitex. (2011, February 6). Haversine formula in Python (bearing and distance between two GPS points). Stack Overflow. https://stackoverflow.com/questions/4913349/haversine-formula-in-python-bearing-and-distance-between-two-gps-points

-	APLICACI√ìN ALGORITMO DE ENJAMBRE DE PARTICULAS PARA OPTIMIZACI√ìN PATZ EN REDES DE RIEGO. (2023). Easy Hidro. https://www.serea23.com/wp-content/uploads/2023/06/6257.pdf

-	Optimizaci√≥n de Enjambre de Part√≠culas aplicada al problema del Viajero Bi-objetivo. (2006). Inteligencia Artificial. Revista Iberoamericana, 10(32). https://www.redalyc.org/pdf/925/92503209.pdf

-	Yadav, A. (2023, March 30). Distance between two Geo-Locations in Python - AskPython. AskPython. https://www.askpython.com/python/examples/find-distance-between-two-geo-locations


## Autores

- [Pe√±a Lopez Miguel Angel ](https://github.com/KingSplatt)

- [Robles Rios Jacquelin](https://github.com/jacq1813)
